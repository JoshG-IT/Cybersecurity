# SOC KPI Sheet (Sentinel + MDE)

This sheet tracks weekly threat-hunting, alert triage, and incident investigations.  

Each row ties **Event Time > Detection Time > Response Time > Disposition > Evidence**.

---

## Key Metric Definitions
- **MTTD (Mean Time to Detect):** Event > Detection  
- **MTTR (Mean Time to Respond):** Detection > Investigation completed  
- **True Positive (TP):** Confirmed malicious behavior  
- **False Positive (FP):** Benign behavior  
- **Hunts Completed:** Number of KQL threat hunts performed  
- **Incidents Generated:** Total investigations this week  

---

## Source Definitions  
These are the only data sources used in this KPI sheet:

- **MDE (Microsoft Defender for Endpoint):** Endpoint detections (ASR, malware, suspicious processes).  
- **Sentinel Alert:** Alerts generated by Microsoft Sentinel analytics.  
- **KQL Hunt:** Proactive threat-hunting queries written manually in Sentinel.  

---

# WEEK 1 - 2025-01-10

| Incident ID | Event Time | Detection Time | Alert / Hunt Name | Source | Type | MTTD | MTTR | Notes | Disposition | Evidence |
|-------------|------------|----------------|--------------------|--------|------|------|------|--------|-------------|----------|
| INC-2025-01-10-001 | 11:42 | 11:47 | Suspicious PowerShell Execution | MDE | TP | 5m | 22m | Encoded command blocked via ASR. No persistence found. | Contained – ASR block. No escalation. | INSERT IMAGE |
| INC-2025-01-10-002 | 09:13 | 09:17 | Unusual Login Activity | Sentinel Alert | FP | 4m | 12m | MFA travel event; user confirmed activity. | Closed – False positive. | INSERT IMAGE |
| INC-2025-01-10-003 | 14:00 | 14:00 | SMB Reconnaissance Hunt | KQL Hunt | N/A | 30m | 30m | 3 flags found: SMB scan, failed logins, share enumeration. | Closed – No active threat observed. | INSERT IMAGE |
| INC-2025-01-10-004 | 08:30 | 08:48 | Windows Persistence Review | KQL Hunt | N/A | 18m | 18m | Reviewed autoruns/WMI/tasks; no malicious persistence. | Closed – No threat detected. | INSERT IMAGE |

---

# WEEK 2 - 2025-01-17

| Incident ID | Event Time | Detection Time | Alert / Hunt Name | Source | Type | MTTD | MTTR | Notes | Disposition | Evidence |
|-------------|------------|----------------|--------------------|--------|------|------|------|--------|-------------|----------|
| INC-2025-01-17-001 | 03:14 | 03:21 | SSH Brute Force (Linux VM) | Sentinel Alert | TP | 7m | 18m | 40+ SSH attempts from RU IP. NSG rule updated. | Contained – NSG block applied. | INSERT IMAGE |
| INC-2025-01-17-002 | 12:55 | 13:01 | ASR Block: Malicious Macro | MDE | TP | 6m | 20m | Macro payload blocked. User reported phishing email. | Contained – File blocked, user educated. | INSERT IMAGE |
| INC-2025-01-17-003 | 19:03 | 19:03 | Lateral Movement Attempt Hunt | KQL Hunt | N/A | 45m | 45m | Flags: IPC$ access attempts + failed PsExec usage. | Escalated – Possible credential misuse. | INSERT IMAGE |
| INC-2025-01-17-004 | 07:22 | 07:50 | Suspicious Bash History Review | KQL Hunt | N/A | 28m | 28m | Investigated unusual bash commands on Linux VM. | Closed – Admin testing scripts. | INSERT IMAGE |

---

# WEEK 3 - 2025-01-24

| Incident ID | Event Time | Detection Time | Alert / Hunt Name | Source | Type | MTTD | MTTR | Notes | Disposition | Evidence |
|-------------|------------|----------------|--------------------|--------|------|------|------|--------|-------------|----------|
| INC-2025-01-24-001 | 16:41 | 16:45 | Suspicious Token Theft Attempt | MDE | TP | 4m | 33m | LSASS read attempt detected. Investigated user session. | Contained – Blocked by EDR. | INSERT IMAGE |
| INC-2025-01-24-002 | 05:12 | 05:14 | Impossible Travel Alert | Sentinel Alert | FP | 2m | 10m | VPN IP mismatch. No compromise. | Closed – False positive. | INSERT IMAGE |
| INC-2025-01-24-003 | 10:00 | 10:00 | RDP Brute Force (Internal) | KQL Hunt | N/A | 42m | 42m | 5 flags: failed logins, RDP scan, RDCMan signature. | Escalated – Potential insider recon. | INSERT IMAGE |
| INC-2025-01-24-004 | 14:30 | 14:57 | Suspicious Scheduled Task | MDE | TP | 27m | 35m | Task created via PowerShell linked to script. | Contained – Task removed and user reset. | INSERT IMAGE |

---

# WEEK 4 - 2025-01-31

| Incident ID | Event Time | Detection Time | Alert / Hunt Name | Source | Type | MTTD | MTTR | Notes | Disposition | Evidence |
|-------------|------------|----------------|--------------------|--------|------|------|------|--------|-------------|----------|
| INC-2025-01-31-001 | 01:11 | 01:18 | Malware Detection: Trojan Downloader | MDE | TP | 7m | 41m | File quarantined. Network activity blocked. | Contained – Quarantined by MDE. | INSERT IMAGE |
| INC-2025-01-31-002 | 08:22 | 08:26 | Suspicious OAuth Consent Attempt | Sentinel Alert | TP | 4m | 28m | Unauthorized app requested OAuth permissions. | Escalated – Identity team notified. | INSERT IMAGE |
| INC-2025-01-31-003 | 13:10 | 13:10 | PowerShell Recon Hunt | KQL Hunt | N/A | 31m | 31m | Flags: Get-ADRecon + encoded commands + clipboard access. | Closed – No active threat, recon-only activity. | INSERT IMAGE |
| INC-2025-01-31-004 | 06:44 | 07:15 | Linux Privilege Escalation Attempt | MDE | TP | 31m | 37m | SUID privilege escalation attempt detected. | Contained – Blocked & user disabled. | INSERT IMAGE |

---

## Column Definitions

- **Incident ID**  
  A unique identifier you assign to each investigation. Used to track multiple alerts or hunts occurring on the same day.

- **Event Time**  
  The timestamp of when the activity actually occurred on the device or in the logs.

- **Detection Time**  
  When the alert was generated OR when the analyst discovered suspicious activity during a KQL hunt.

- **Alert / Hunt Name**  
  The name of the Sentinel/MDE alert or the title of the KQL-based manual hunt.

- **Source**  
  Where the detection or hunt originated:
  - **MDE** – Microsoft Defender for Endpoint alert  
  - **Sentinel Alert** – Analytics rule 
  - **KQL Hunt** – Manual proactive threat-hunting query

- **Type**  
  Classification of the event:
  - **TP (True Positive)** – confirmed malicious  
  - **FP (False Positive)** – benign or expected behavior

- **MTTD**  
  **Mean Time to Detect.**  
  The difference between **Event Time** and **Detection Time**. This shows how quickly the threat was detected.

- **MTTR**  
  **Mean Time to Respond.**  
  MTTR represents **the total time spent investigating and responding** to the alert(s).

- **Notes**  
  Key observations, indicators found, flags discovered, or behavior analyzed during the investigation.

- **Disposition**  
  Final outcome of the investigation:
  - Contained  
  - Closed – False Positive  
  - Escalated  
  - No threat detected  
  - User educated  
  - NSG updated  
  - Quarantined  
  - Task removed  
  - Monitoring  

- **Evidence**  
  Screenshot or proof of the finding (MDE alert, Sentinel alert, KQL output).

